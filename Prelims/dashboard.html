<!DOCTYPE html>
<html lang="en" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UPSC Prelims Dashboard: GS & CSAT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- IMPORTANT: Base href adjusted for the new Prelims/ directory structure -->
    <base href="https://pratyushswain01.github.io/UPSCstudyhub.github.io/Prelims/">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .footer-nav a.active { color: #2563EB; transform: scale(1.1); }
        .footer-nav a { transition: color 0.2s ease-in-out, transform 0.2s ease-in-out; }
        .tab-active { background-color: #3B82F6; color: white; }
        .modal-backdrop { background-color: rgba(0, 0, 0, 0.5); backdrop-filter: blur(4px); }
         
        @keyframes fall {
            0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
        }
        .confetti-piece {
            position: absolute; width: 10px; height: 20px; border-radius: 50%;
            opacity: 0; animation: fall 5s linear infinite;
        }
        .toggle-checkbox:checked + .toggle-label { background-color: #3B82F6; }
        .toggle-checkbox { transition: transform 0.2s ease-in-out; }
        .toggle-checkbox:checked { transform: translateX(1rem); }
        .sidebar-item.active { 
            background-color: #3B82F6; 
            color: white; 
            font-weight: 600;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        .sidebar-item.active svg {
            color: white;
        }

        /* Styling for the main content to look good */
        .dashboard-container {
            max-width: 1400px;
            margin: auto;
        }
        
        #welcome-banner {
            position: relative;
            background-size: cover;
            background-position: center;
            transition: background-image 0.5s ease-in-out;
            overflow: hidden;
        }
        #welcome-banner::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0, 0, 0, 0.35);
            border-radius: 1rem;
            z-index: 1;
        }
        #welcome-banner > * {
            position: relative;
            z-index: 2;
        }
    </style>
    <script>
        tailwind.config = { darkMode: 'class' }
    </script>
</head>
<body class="bg-slate-100 dark:bg-slate-900 text-slate-800 dark:text-slate-200">

    <!-- MODAL PLACEHOLDERS (Minimal required structure) -->
    <div id="alert-modal" class="hidden fixed inset-0 z-[70] flex items-center justify-center p-4 modal-backdrop">
        <div class="bg-white dark:bg-slate-800 rounded-xl shadow-lg w-full max-w-sm text-center p-6">
            <p id="alert-message" class="font-medium"></p>
            <button id="alert-ok" class="mt-4 px-6 py-2 text-sm font-semibold rounded-lg bg-blue-600 text-white hover:bg-blue-700">OK</button>
        </div>
    </div>
    
    <div id="app-view" class="hidden"> <!-- Initially hidden until user loads -->
        <header class="bg-white/80 dark:bg-slate-800/80 backdrop-blur-md shadow-sm sticky top-0 z-50">
            <div class="container mx-auto px-4 sm:px-6 py-3 flex justify-between items-center">
                <div class="flex items-center gap-2">
                    <button id="sidebar-toggle" class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                    </button>
                    <!-- Link adjusted relative to Prelims/dashboard.html -->
                    <a href="../dashboard.html" class="flex items-center gap-2 text-2xl font-bold text-blue-600 dark:text-blue-500">
                        <img src="https://pratyushswain01.github.io/UPSCstudyhub.github.io/images/LOGO.jpg" alt="UPSChub Logo" class="h-8 w-8 rounded-lg">
                        <span>UPSChub</span>
                    </a>
                </div>
                <!-- Header right side -->
                <div class="flex items-center gap-4">
                    <!-- Streak Placeholder -->
                    <button id="streak-btn" class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">
                        <svg class="h-6 w-6 text-orange-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7.014A8.003 8.003 0 0122 12c0 3-1 6-3.5 6-1.667 0-2.5-1.5-2.5-3s1-2.5 2.5-2.5c1.105 0 2.14.44 2.899 1.157" /></svg>
                    </button>
                    <!-- Calendar Placeholder -->
                    <button id="calendar-btn" class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">
                        <svg class="h-6 w-6 text-slate-500 dark:text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                    </button>
                    <div id="account-info-div" class="relative">
                        <button id="account-btn" class="w-9 h-9 bg-slate-200 dark:bg-slate-700 rounded-full flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-slate-500 dark:text-slate-400"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-5.5-2.5a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0zM10 12a5.99 5.99 0 00-4.793 2.39A6.483 6.483 0 0010 16.5a6.483 6.483 0 004.793-2.11A5.99 5.99 0 0010 12z" clip-rule="evenodd" /></svg>
                        </button>
                        <!-- Account Dropdown -->
                        <div id="account-dropdown" class="hidden absolute right-0 mt-2 w-56 bg-white dark:bg-slate-800 rounded-lg shadow-xl py-2 z-20">
                            <div class="px-4 py-2 border-b dark:border-slate-700">
                                <p class="font-semibold text-sm" id="dropdown-display-name">UPSC Aspirant</p>
                                <p class="text-xs text-slate-500 dark:text-slate-400 truncate" id="user-email-display">user@example.com</p>
                            </div>
                            <div class="border-t border-slate-200 dark:border-slate-700"></div>
                            <a href="#" id="logout-btn" class="block w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-500 hover:bg-slate-100 dark:hover:bg-slate-700">Logout</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>
         
        <div class="relative min-h-screen">
             <div id="sidebar-backdrop" class="fixed inset-0 bg-black/50 z-30 hidden md:hidden"></div>
             
             <!-- CUSTOMIZED SIDEBAR FOR PRELIMS FOCUS -->
             <aside id="sidebar" class="fixed top-0 left-0 h-full bg-white dark:bg-slate-800 shadow-lg w-64 transform -translate-x-full transition-transform duration-300 ease-in-out z-40 pt-20 md:translate-x-0">
                 <nav class="p-4">
                     <h3 class="text-xs font-bold uppercase text-slate-500 dark:text-slate-400 mb-2 px-3">Prelims Components</h3>
                     <ul class="space-y-2">
                         <!-- GS Section: Active Tab -->
                         <li>
                            <a href="#" id="sidebar-gs" data-target-view="gs-view" class="sidebar-item active flex items-center gap-3 px-3 py-2.5 rounded-lg font-medium">
                                <svg class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m-9 14h7m-7 0L3 18m14 3a2 2 0 002-2v-2m-12-3V6a2 2 0 012-2h2m0 10V6a2 2 0 00-2-2h-2" /></svg> 
                                General Studies (GS)
                            </a>
                        </li>
                         <!-- CSAT Section: Inactive Tab -->
                         <li>
                            <a href="#" id="sidebar-csat" data-target-view="csat-view" class="sidebar-item flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 font-medium">
                                <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M7 12l3-3 3 3 4-4M18 21V5a2 2 0 00-2-2H8a2 2 0 00-2 2v16m12 0h2m-2 0h-5m-9 0H3m2 0h5M6 17h10M6 13h10" /></svg> 
                                CSAT (Paper II)
                            </a>
                        </li>
                     </ul>

                     <h3 class="text-xs font-bold uppercase text-slate-500 dark:text-slate-400 mt-6 mb-2 px-3 border-t pt-4 border-slate-200 dark:border-slate-700">Navigation</h3>
                     <ul class="space-y-2">
                         <li><a href="../dashboard.html" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 font-medium"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" /></svg> Main Dashboard</a></li>
                         <li><a href="../TestSeries/test_hub.html" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 font-medium"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> Test Library</a></li>
                     </ul>
                 </nav>
             </aside>

             <!-- Main Content Area with conditional views -->
             <main id="main-content" class="flex-1 transition-all duration-300 ease-in-out md:ml-64">
                 <div class="dashboard-container mx-auto p-4 sm:p-6 pb-24">
                     
                     <!-- GS View: Default Active -->
                     <div id="gs-view">
                         <h1 class="text-3xl font-bold mb-6 text-slate-800 dark:text-white">General Studies Resources</h1>
                         <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                             
                             <div class="lg:col-span-2 space-y-6">
                                 <!-- Welcome Banner/GS Header -->
                                 <div id="welcome-banner-gs" class="bg-gradient-to-r from-blue-600 to-cyan-700 p-6 rounded-2xl shadow-lg text-white">
                                     <h2 id="gs-welcome-heading" class="text-3xl font-bold">GS: Focus on Coverage!</h2>
                                     <p class="mt-1 opacity-80">Explore the syllabus and essential reading list for General Studies.</p>
                                 </div>
                                 
                                 <!-- GS Stat Cards (Re-purposed for Key Syllabus Areas) -->
                                 <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4">
                                     <div class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm flex items-center gap-4">
                                         <div class="bg-green-100 dark:bg-green-900/50 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600 dark:text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.247m0-13C13.168 5.477 14.754 5 16.5 5s3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18s-3.332.477-4.5 1.247" /></svg></div>
                                         <div><p class="text-sm text-slate-500 dark:text-slate-400">Total Subjects</p><p id="gs-total-subjects" class="text-lg font-bold">7 Major</p></div> 
                                     </div>
                                     <div class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm flex items-center gap-4">
                                         <div class="bg-blue-100 dark:bg-blue-900/50 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" /></svg></div>
                                         <div><p class="text-sm text-slate-500 dark:text-slate-400">Current Affairs</p><p id="gs-ca-focus" class="text-lg font-bold">18 Months</p></div>
                                     </div>
                                     <div class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm flex items-center gap-4">
                                         <div class="bg-red-100 dark:bg-red-900/50 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-600 dark:text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14v6m-3-3h6M6 10h2m0 0h2m-2 0V6m-2 4h2m0 0V6m0 4h2m-2 0V6m-2 4h2m0 0V6m-2 4h2m0 0V6m-2 4h2m0 0V6" /></svg></div>
                                         <div><p class="text-sm text-slate-500 dark:text-slate-400">Mandatory Readings</p><p id="gs-mandatory-readings" class="text-lg font-bold">NCERTs (6-12)</p></div>
                                     </div>
                                     <div class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm flex items-center gap-4">
                                         <div class="bg-indigo-100 dark:bg-indigo-900/50 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-600 dark:text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 00-2 2v8a2 2 0 002 2m0-10V4m0 2a2 2 0 012 2v8a2 2 0 01-2 2m-3-3h6" /></svg></div>
                                         <div><p class="text-sm text-slate-500 dark:text-slate-400">Revision Cycles</p><p id="gs-revision-cycles" class="text-lg font-bold">3+ Recommended</p></div>
                                     </div>
                                 </div>
                                 
                                 <!-- GS Syllabus Overview (Replaces Chart) -->
                                 <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm">
                                     <h3 class="text-lg font-bold mb-4">UPSC Prelims GS Syllabus Core Areas</h3>
                                     <ul class="list-disc pl-5 space-y-2 text-sm text-slate-600 dark:text-slate-300">
                                         <li>Current events of National and International importance.</li>
                                         <li>History of India and Indian National Movement.</li>
                                         <li>Indian and World Geography - Physical, Social, Economic Geography of India and the World.</li>
                                         <li>Indian Polity and Governance - Constitution, Political System, Panchayati Raj, Public Policy, Rights Issues, etc.</li>
                                         <li>Economic and Social Development - Sustainable Development, Poverty, Inclusion, Demographics, Social Sector Initiatives, etc.</li>
                                         <li>General issues on Environmental Ecology, Bio-diversity and Climate Change.</li>
                                         <li>General Science.</li>
                                     </ul>
                                     <button class="mt-4 text-center text-sm font-semibold text-blue-600 hover:underline">Download Detailed Syllabus PDF</button>
                                 </div>
                                 
                                 <!-- GS Essential Books (Replaces Recent Results) -->
                                 <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm">
                                     <h3 class="text-lg font-bold mb-4">GS Essential Reading List (Standard Books)</h3>
                                     <div id="gs-recent-tests-container" class="space-y-4 text-sm">
                                         <div class="p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg flex justify-between items-center">
                                             <p class="font-semibold">Polity:</p> <span class="text-slate-500">M. Laxmikanth</span>
                                         </div>
                                         <div class="p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg flex justify-between items-center">
                                             <p class="font-semibold">Modern History:</p> <span class="text-slate-500">Spectrum (Rajiv Ahir)</span>
                                         </div>
                                         <div class="p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg flex justify-between items-center">
                                             <p class="font-semibold">Geography:</p> <span class="text-slate-500">G.C. Leong + NCERTs</span>
                                         </div>
                                     </div>
                                     <button class="mt-4 w-full text-center text-sm font-semibold text-blue-600 hover:underline">View Full Book List & Notes</button>
                                 </div>
                             </div>
                             
                             <!-- GS Study Pattern / Right Sidebar -->
                             <div class="lg:col-span-1 space-y-6">
                                 <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm sticky top-24">
                                     <h3 class="text-lg font-bold mb-4 flex justify-between items-center">
                                         Recommended Study Pattern
                                     </h3>
                                     <div id="gs-subject-focus" class="space-y-3">
                                        <div class="p-3 bg-indigo-50 dark:bg-indigo-900/10 rounded-lg"><p class="font-semibold text-indigo-600 text-sm">Phase 1 (Concepts):</p><p class="text-xs text-slate-500">Complete 70% of static syllabus. Daily CA reading.</p></div>
                                        <div class="p-3 bg-purple-50 dark:bg-purple-900/10 rounded-lg"><p class="font-semibold text-purple-600 text-sm">Phase 2 (Integration):</p><p class="text-xs text-slate-500">Attempt subject tests, link CA to static portions.</p></div>
                                        <div class="p-3 bg-teal-50 dark:bg-teal-900/10 rounded-lg"><p class="font-semibold text-teal-600 text-sm">Phase 3 (Testing):</p><p class="text-xs text-slate-500">Full-length mocks & intensive revision (3 cycles min).</p></div>
                                     </div>
                                     <button class="mt-4 w-full text-center text-sm font-semibold text-blue-600 hover:underline">Create Custom Study Plan</button>
                                 </div>
                             </div>
                         </div>
                     </div>
                     
                     <!-- CSAT View: Initially Hidden -->
                     <div id="csat-view" class="hidden">
                        <h1 class="text-3xl font-bold mb-6 text-slate-800 dark:text-white">CSAT Resources (Paper II)</h1>
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                             
                            <div class="lg:col-span-2 space-y-6">
                                <!-- Welcome Banner/CSAT Header -->
                                <div id="welcome-banner-csat" class="bg-gradient-to-r from-amber-600 to-orange-700 p-6 rounded-2xl shadow-lg text-white">
                                    <h2 id="csat-welcome-heading" class="text-3xl font-bold">CSAT: Focus on Practice!</h2>
                                    <p class="mt-1 opacity-80">Resources for Aptitude, Reasoning, and Comprehension.</p>
                                </div>
                                
                                <!-- CSAT Stat Cards (Re-purposed) -->
                                <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4">
                                    <div class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm flex items-center gap-4">
                                        <div class="bg-amber-100 dark:bg-amber-900/50 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-amber-600 dark:text-amber-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg></div>
                                        <div><p class="text-sm text-slate-500 dark:text-slate-400">Total Questions</p><p id="csat-total-questions" class="text-lg font-bold">80 Qs</p></div> 
                                    </div>
                                    <div class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm flex items-center gap-4">
                                        <div class="bg-purple-100 dark:bg-purple-900/50 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-600 dark:text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" /></svg></div>
                                        <div><p class="text-sm text-slate-500 dark:text-slate-400">Qualifying Score</p><p id="csat-qualifying-score" class="text-lg font-bold">66 Marks</p></div>
                                    </div>
                                    <div class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm flex items-center gap-4">
                                        <div class="bg-pink-100 dark:bg-pink-900/50 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-pink-600 dark:text-pink-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01M12 6a2 2 0 100-4 2 2 0 000 4zm0 12a2 2 0 100-4 2 2 0 000 4zm0 0V10m0 10a9 9 0 110-18 9 9 0 010 18z" /></svg></div>
                                        <div><p class="text-sm text-slate-500 dark:text-slate-400">RC Weightage</p><p id="csat-rc-weightage" class="text-lg font-bold">~40-45%</p></div>
                                    </div>
                                    <div class="bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm flex items-center gap-4">
                                        <div class="bg-teal-100 dark:bg-teal-900/50 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-teal-600 dark:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg></div>
                                        <div><p class="text-sm text-slate-500 dark:text-slate-400">Practice Goal</p><p id="csat-practice-goal" class="text-lg font-bold">Daily 1 hr</p></div>
                                    </div>
                                </div>
                                
                                <!-- CSAT Syllabus Overview (Replaces Chart) -->
                                <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm">
                                    <h3 class="text-lg font-bold mb-4">CSAT Syllabus Core Areas</h3>
                                    <ul class="list-disc pl-5 space-y-2 text-sm text-slate-600 dark:text-slate-300">
                                        <li>Comprehension</li>
                                        <li>Interpersonal skills including communication skills;</li>
                                        <li>Logical reasoning and analytical ability.</li>
                                        <li>Decision-making and problem-solving.</li>
                                        <li>General mental ability.</li>
                                        <li>Basic numeracy (Class X level) and Data Interpretation (Class X level).</li>
                                    </ul>
                                    <button class="mt-4 text-center text-sm font-semibold text-amber-600 hover:underline">View Topic-wise Breakdown</button>
                                </div>
                                
                                <!-- CSAT Essential Books (Replaces Recent Results) -->
                                <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm">
                                    <h3 class="text-lg font-bold mb-4">CSAT Essential Reading/Practice List</h3>
                                    <div id="csat-recent-tests-container" class="space-y-4 text-sm">
                                        <div class="p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg flex justify-between items-center">
                                            <p class="font-semibold">Reading Comprehension:</p> <span class="text-slate-500">Past Year Papers (Critical)</span>
                                        </div>
                                        <div class="p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg flex justify-between items-center">
                                            <p class="font-semibold">Aptitude/Reasoning:</p> <span class="text-slate-500">RS Aggarwal (Select Chapters)</span>
                                        </div>
                                        <div class="p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg flex justify-between items-center">
                                            <p class="font-semibold">General Mental Ability:</p> <span class="text-slate-500">M.K. Pandey</span>
                                        </div>
                                    </div>
                                    <button class="mt-4 w-full text-center text-sm font-semibold text-amber-600 hover:underline">View Advanced Practice Sources</button>
                                </div>
                            </div>
                            
                            <!-- CSAT Strategy / Right Sidebar -->
                            <div class="lg:col-span-1 space-y-6">
                                <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm sticky top-24">
                                    <h3 class="text-lg font-bold mb-4 flex justify-between items-center">
                                        CSAT Strategy Guide
                                    </h3>
                                    <div id="csat-focus-area" class="space-y-3">
                                        <div class="p-3 bg-red-50 dark:bg-red-900/10 rounded-lg"><p class="font-semibold text-red-600 text-sm">Rule 1: Never Ignore</p><p class="text-xs text-slate-500">CSAT is qualifying but high failure rates mean it must be respected.</p></div>
                                        <div class="p-3 bg-yellow-50 dark:bg-yellow-900/10 rounded-lg"><p class="font-semibold text-yellow-600 text-sm">Rule 2: Selectivity</p><p class="text-xs text-slate-500">Master 40-45 Qs with high accuracy, don't try all 80.</p></div>
                                        <div class="p-3 bg-green-50 dark:bg-green-900/10 rounded-lg"><p class="font-semibold text-green-600 text-sm">Rule 3: Time Management</p><p class="text-xs text-slate-500">Practice full length mocks under strict 2-hour conditions.</p></div>
                                    </div>
                                    <button class="mt-4 w-full text-center text-sm font-semibold text-amber-600 hover:underline">CSAT Time Allocation Planner</button>
                                </div>
                            </div>
                        </div>
                     </div>
                     
                     <!-- NEW: NOTIFICATIONS VIEW (FOR FOOTER NAVIGATION) -->
                     <div id="notifications-view" class="hidden">
                         <h1 class="text-3xl font-bold text-slate-800 dark:text-white mb-6">Notifications (Prelims Hub)</h1>
                         <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm p-6 text-center text-slate-500">
                             No new updates regarding Prelims resources.
                         </div>
                     </div>
                     
                     <!-- NEW: SETTINGS VIEW (FOR FOOTER NAVIGATION) -->
                     <div id="settings-view" class="hidden">
                         <h1 class="text-3xl font-bold text-slate-800 dark:text-white mb-6">Settings & Profile</h1>
                         <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm p-6 text-center text-slate-500">
                             General settings are handled here. (Functionality placeholders retained in JS)
                         </div>
                     </div>

                     <div class="text-center mt-8 pt-8 border-t border-slate-200 dark:border-slate-700">
                         <p class="text-sm text-slate-500 dark:text-slate-400">Â© 2025 UPSChub. All Rights Reserved.</p>
                     </div>
                 </div>
             </main>
        </div>
         
        <!-- Footer Navigation -->
        <footer class="fixed bottom-0 left-0 right-0 bg-white/80 dark:bg-slate-800/80 backdrop-blur-md shadow-[0_-2px_5px_-1px_rgba(0,0,0,0.1)] z-50">
             <nav class="container mx-auto px-4 h-16 flex justify-around items-center footer-nav">
                <!-- Links adjusted relative to Prelims/dashboard.html -->
                <a href="../homeUPSChub.html" id="nav-home" class="flex flex-col items-center justify-center text-slate-500 dark:text-slate-400"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg><span class="text-xs font-medium">Home</span></a>
                <a href="../dashboard.html" id="nav-dashboard" class="flex flex-col items-center justify-center text-slate-500 dark:text-slate-400"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" /></svg><span class="text-xs font-medium">Dashboard</span></a>
                <a href="#" id="nav-tests" class="flex flex-col items-center justify-center text-blue-600 dark:text-blue-500 active"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" /></svg><span class="text-xs font-medium">Prelims</span></a>
                <a href="#" id="nav-notifications" class="flex flex-col items-center justify-center text-slate-500 dark:text-slate-400"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" /></svg><span class="text-xs font-medium">Notify</span></a>
                <a href="#" id="nav-settings" class="flex flex-col items-center justify-center text-slate-500 dark:text-slate-400"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg><span class="text-xs font-medium">Settings</span></a>
             </nav>
        </footer>
    </div>

    <!-- Placeholder HTML for missing modals/elements to prevent JS errors -->
    <div id="alert-modal" class="hidden"> <p id="alert-message"></p><button id="alert-ok"></button></div>
    <div id="streak-tooltip" class="hidden"> <span id="current-streak">0</span><span id="highest-streak">0</span></div>
    <div id="user-email-display" class="hidden"></div>
    <div id="dropdown-display-name" class="hidden">UPSC Aspirant</div>
    <div id="dropdown-theme-toggle" class="hidden"></div>
    <div id="settings-display-name" class="hidden"></div>
    <div id="settings-user-email" class="hidden"></div>
    <div id="subscription-item" class="hidden"></div>
    <!-- End Placeholder HTML -->


<script type="module">
    // --- FIREBASE IMPORTS ---
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, doc, updateDoc, setDoc, collection, query, orderBy, getDocs, getDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    // --- FIREBASE CONFIG ---
    const firebaseConfig = { apiKey: "AIzaSyBoPtr3d8se-fcGXkzixG8OE7dFvYjPcs4", authDomain: "upscstudyhub-github.firebaseapp.com", projectId: "upscstudyhub-github", storageBucket: "upscstudyhub-github.firebasestorage.app", messagingSenderId: "451692540885", appId: "1:451692540885:web:b425e85128e5de97c7c35c" };
    // We use a specific App ID for this module to ensure unique data paths
    const appId = typeof __app_id !== 'undefined' ? __app_id : 'prelims-app-id';
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // --- ELEMENT SELECTORS ---
    const appView = document.getElementById('app-view'); 
    const sidebar = document.getElementById('sidebar');
    const sidebarToggle = document.getElementById('sidebar-toggle');
    const mainContentElement = document.getElementById('main-content');
    const sidebarGsLink = document.getElementById('sidebar-gs');
    const sidebarCsatLink = document.getElementById('sidebar-csat');
    const gsView = document.getElementById('gs-view');
    const csatView = document.getElementById('csat-view');
    const accountDropdown = document.getElementById('account-dropdown'); 
    const accountBtn = document.getElementById('account-btn');
    const navNotifications = document.getElementById('nav-notifications');
    const navSettings = document.getElementById('nav-settings');
    const navTests = document.getElementById('nav-tests');

    // View containers added for the router logic
    const spaViews = { 
        gs: gsView, 
        csat: csatView, 
        notifications: document.getElementById('notifications-view'), 
        settings: document.getElementById('settings-view') 
    };

    // Required by utility functions (defined as placeholders in HTML)
    const alertModal = document.getElementById('alert-modal');
    const alertMessage = document.getElementById('alert-message');
    const dropdownDisplayName = document.getElementById('dropdown-display-name');
    const welcomeBanner = document.getElementById('welcome-banner-gs'); // Use GS banner for time update
    
    let currentView = 'gs-view';
    let gsChartInstance = null;
    let csatChartInstance = null;
    let timeUpdateInterval = null; 

    // --- AUTHENTICATION & INITIALIZATION ---
    onAuthStateChanged(auth, async user => {
        if (user) {
            console.log('User logged in. Loading Prelims Dashboard...');
            
            // Step 1: Handle authentication token for Canvas environment
            if (typeof __initial_auth_token !== 'undefined') { 
                await signInWithCustomToken(auth, __initial_auth_token).catch(err => {
                    console.error("Custom token sign-in failed:", err);
                });
            } else {
                await signInAnonymously(auth).catch(err => {
                    console.error("Anonymous sign-in failed:", err);
                });
            }
            
            // Set App visible immediately after auth check
            appView.classList.remove('hidden'); 
            
            // Initialize basic UI components
            if (dropdownDisplayName) dropdownDisplayName.textContent = user.displayName || 'UPSC Aspirant';
            initializeTimeBasedUI(); 

            // Step 2: Render UI and attach listeners
            handleSidebarState(); 
            attachEventListeners();
            
            // Step 3: Initialize Charts (required before data fetching)
            // We initialize but never populate them since this is a resource page.
            renderPerformanceChart('gsPerformanceChart', '#3B82F6');
            renderPerformanceChart('csatPerformanceChart', '#F59E0B');
            
            // Step 4: Load Data for Default View (GS)
            loadResourceData(user.uid, 'gs-view');

            // Set initial active view state
            switchView('gs-view');

        } else {
            console.log('User is not logged in. Redirecting to auth page...');
            // Link adjusted relative to Prelims/dashboard.html
            window.location.href = '../auth.html'; 
        }
    });

    // --- UTILITY FUNCTIONS ---
    function showAlert(message) { 
        if (alertMessage && alertModal) {
            alertMessage.textContent = message; 
            alertModal.classList.remove('hidden'); 
        } else {
             console.error("Alert modal elements missing. Message:", message);
        }
    }
    
    function initializeTimeBasedUI() {
        updateTimeAndGreeting();
        if (timeUpdateInterval) clearInterval(timeUpdateInterval);
        timeUpdateInterval = setInterval(updateTimeAndGreeting, 1000);
    }
    
    function updateTimeAndGreeting() {
        const morningImage = 'https://images.unsplash.com/photo-1470252649378-9c29740c9fa8?q=80&w=2070&auto=format&fit=crop';
        const afternoonImage = 'https://images.unsplash.com/photo-1590306362572-215a054a88f5?q=80&w=2070&auto=format&fit=crop';
        const eveningImage = 'https://images.unsplash.com/photo-1505322022379-7c3353ee6291?q=80&w=1974&auto=format&fit=crop';

        const now = new Date();
        const hour = now.getHours();
        
        const name = dropdownDisplayName.textContent.split(' ')[0] || 'Aspirant';
        let greetingText;
        
        if (hour >= 5 && hour < 12) {
            greetingText = `Good Morning, ${name}!`;
        } else if (hour >= 12 && hour < 18) {
            greetingText = `Good Afternoon, ${name}!`;
        } else {
            greetingText = `Good Evening, ${name}!`;
        }
        
        const gsWelcomeHeading = document.getElementById('gs-welcome-heading');
        const csatWelcomeHeading = document.getElementById('csat-welcome-heading');
        
        if (gsWelcomeHeading) gsWelcomeHeading.textContent = `GS: ${greetingText.replace(', Aspirant!', '!')}`;
        if (csatWelcomeHeading) csatWelcomeHeading.textContent = `CSAT: ${greetingText.replace(', Aspirant!', '!')}`;
    }
    
    function handleLogout(e) { e.preventDefault(); signOut(auth).catch(error => console.error("Logout error:", error)); }
    
    // --- SIDEBAR LOGIC ---
    function handleSidebarState() {
        if (window.innerWidth >= 768) {
            sidebar.classList.remove('-translate-x-full'); 
            mainContentElement.classList.add('md:ml-64');
        } else {
            sidebar.classList.add('-translate-x-full');
            mainContentElement.classList.remove('md:ml-64');
        }
    }
    
    function toggleSidebar() { 
        sidebar.classList.toggle('-translate-x-full'); 
        const sidebarBackdrop = document.getElementById('sidebar-backdrop');
        if (sidebarBackdrop) sidebarBackdrop.classList.toggle('hidden');
    }
    
    // --- VIEW SWITCHING (Handles Footer Navigation) ---
    function switchView(viewName) {
        let normalizedViewName;

        // Determine if the request is for a component view or a static footer view
        if (viewName === 'gs-view' || viewName === 'csat-view') {
            normalizedViewName = viewName;
            // Hide static footer views
            spaViews.notifications.classList.add('hidden');
            spaViews.settings.classList.add('hidden');
            // Show only the requested component view
            gsView.classList.add('hidden');
            csatView.classList.add('hidden');
            if (viewName === 'gs-view') {
                gsView.classList.remove('hidden');
            } else {
                csatView.classList.remove('hidden');
            }
        } else {
            normalizedViewName = viewName;
            // Hide all content views
            gsView.classList.add('hidden');
            csatView.classList.add('hidden');

            // Hide/Show correct static view
            for (const key in spaViews) {
                if (key !== 'gs' && key !== 'csat' && spaViews[key]) {
                    spaViews[key].classList.add('hidden');
                }
            }
            if (spaViews[normalizedViewName]) {
                spaViews[normalizedViewName].classList.remove('hidden');
            }
        }

        // Handle Sidebar Activation
        document.querySelectorAll('.sidebar-item').forEach(item => {
            item.classList.remove('active', 'bg-blue-500', 'text-white');
            item.classList.add('text-slate-700', 'dark:text-slate-300', 'hover:bg-slate-100', 'dark:hover:bg-slate-700');
            item.querySelector('svg').style.color = '';
        });
        
        if (normalizedViewName === 'gs-view' || normalizedViewName === 'csat-view') {
            const link = document.getElementById(`sidebar-${normalizedViewName.split('-')[0]}`);
            if (link) {
                link.classList.add('active');
                link.classList.remove('text-slate-700', 'dark:text-slate-300', 'hover:bg-slate-100', 'dark:hover:bg-slate-700');
            }
        }

        // Handle Footer Navigation Activation
        document.querySelectorAll('.footer-nav a').forEach(a => { a.classList.remove('active'); a.querySelector('svg').style.color = ''; });
        
        let activeNavButton = null;
        if (normalizedViewName === 'notifications') { activeNavButton = navNotifications; }
        else if (normalizedViewName === 'settings') { activeNavButton = navSettings; }
        // We use nav-tests for the primary Prelims view state (GS/CSAT)
        else if (normalizedViewName === 'gs-view' || normalizedViewName === 'csat-view') { activeNavButton = navTests; }

        if (activeNavButton) {
            activeNavButton.classList.add('active');
            activeNavButton.querySelector('svg').style.color = '#2563EB';
        }
        
        currentView = normalizedViewName;

        // Load data/resources when switching to GS/CSAT
        if (currentView === 'gs-view' || currentView === 'csat-view') {
             if (auth.currentUser) loadResourceData(auth.currentUser.uid, currentView);
        }
    }


    // --- DATA FETCHING (STATIC/RESOURCE VIEW LOGIC) ---
    async function loadResourceData(userId, type) {
        console.log(`Loading static resource view for ${type}...`);

        const mockResources = {
            'gs-view': {
                subjects: 7,
                ca_focus: '18 Months',
                mandatory: 'NCERTs (6-12)',
                cycles: '3+ Recommended',
            },
            'csat-view': {
                total_qs: 80,
                qualifying: '66 Marks',
                rc_weightage: '~40-45%',
                practice: 'Daily 1 hr'
            }
        };

        const data = mockResources[type];

        // Update the UI based on the view type (Static content update)
        if (type === 'gs-view') {
            document.getElementById('gs-total-subjects').textContent = data.subjects + ' Major';
            document.getElementById('gs-ca-focus').textContent = data.ca_focus;
            document.getElementById('gs-mandatory-readings').textContent = data.mandatory;
            document.getElementById('gs-revision-cycles').textContent = data.cycles;
            
        } else { // CSAT
            document.getElementById('csat-total-questions').textContent = data.total_qs + ' Qs';
            document.getElementById('csat-qualifying-score').textContent = data.qualifying;
            document.getElementById('csat-rc-weightage').textContent = data.rc_weightage;
            document.getElementById('csat-practice-goal').textContent = data.practice;
        }
    }
    
    // --- DUMMY/CHART FUNCTIONS (Kept for compatibility, but simplified to avoid data fetch) ---
    function renderPerformanceChart(canvasId, color) { /* Logic omitted */ }
    function updateChartData(chartInstance, results, canvasId, labelField, dataField) { /* Logic omitted */ }
    function updateRecentResults(container, results, type) { /* Logic omitted */ }
    function updateGSStats(results) { /* Logic omitted */ }
    function updateCSATStats(results) { /* Logic omitted */ }
    function updateSubscriptionUI() { /* Logic omitted */ }
    function handleUpgrade() { showAlert("Upgrade feature not fully implemented in this module."); }


    // --- EVENT LISTENERS ---
    function attachEventListeners() {
        // Toggle Sidebar (Header Button)
        if(sidebarToggle) sidebarToggle.onclick = toggleSidebar;
        
        // Sidebar View Switching (CRITICAL FUNCTIONALITY)
        if(sidebarGsLink) sidebarGsLink.onclick = (e) => { e.preventDefault(); switchView('gs-view'); };
        if(sidebarCsatLink) sidebarCsatLink.onclick = (e) => { e.preventDefault(); switchView('csat-view'); };
        
        // Footer Navigation (CRITICAL FUNCTIONALITY)
        if (navNotifications) navNotifications.onclick = (e) => { e.preventDefault(); switchView('notifications'); };
        if (navSettings) navSettings.onclick = (e) => { e.preventDefault(); switchView('settings'); };
        if (navTests) navTests.onclick = (e) => { e.preventDefault(); switchView('gs-view'); }; // Default to GS view

        // Account Dropdown Toggle 
        if(accountBtn) accountBtn.onclick = () => accountDropdown && accountDropdown.classList.toggle('hidden');
        
        // Logout Button 
        const logoutBtn = document.getElementById('logout-btn');
        if (logoutBtn) logoutBtn.onclick = handleLogout;

        // Handle generic sidebar toggle on click outside (only for mobile)
        const sidebarBackdrop = document.getElementById('sidebar-backdrop');
        if(sidebarBackdrop) sidebarBackdrop.onclick = toggleSidebar;
        
        // Global click handler to close dropdown
        document.onclick = (e) => {
            if (accountBtn && !accountBtn.contains(e.target) && accountDropdown && !accountDropdown.contains(e.target)) {
                 accountDropdown.classList.add('hidden');
            }
        };

        // Alert modal close handler
        const alertOk = document.getElementById('alert-ok');
        if(alertOk) alertOk.addEventListener('click', () => alertModal.classList.add('hidden'));

    }
    
    // --- THEME LOGIC ---
    function applyTheme(theme) {
         const dropdownThemeToggle = document.getElementById('dropdown-theme-toggle');
         if (theme === 'dark') { 
            document.documentElement.classList.add('dark'); 
            if(dropdownThemeToggle) dropdownThemeToggle.checked = true;
         } else { 
            document.documentElement.classList.remove('dark'); 
            if(dropdownThemeToggle) dropdownThemeToggle.checked = false;
         }
         
         if(auth.currentUser) {
            loadResourceData(auth.currentUser.uid, currentView);
         }
    }
    const savedTheme = localStorage.getItem('color-theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    applyTheme(savedTheme);


</script>
</body>
</html>
