let timer = 0; // Timer value in seconds
let interval;
let isRunning = false;

// Check if there's a saved timer value in localStorage
if (localStorage.getItem('timer')) {
    timer = parseInt(localStorage.getItem('timer')); // Retrieve saved timer value
    updateTimerDisplay(); // Update the timer display with saved value
}

// Mark as present
const markPresentButton = document.getElementById('markPresentButton');
const markAbsentButton = document.getElementById('markAbsentButton');
const attendanceStatus = document.getElementById('attendanceStatus');
const streakDisplay = document.getElementById('streakDisplay');

// Attendance and streak-related code
// (similar to the previous implementation)

// Timer Functions

function startTimer() {
    isRunning = true;
    document.getElementById('startButton').disabled = true;
    document.getElementById('pauseButton').disabled = false;

    interval = setInterval(() => {
        timer++; // Increment the timer every second
        localStorage.setItem('timer', timer); // Store the updated timer in localStorage
        updateTimerDisplay(); // Update the timer display
        checkAndUpdateStreak(); // Update the streak based on the timer value
    }, 1000);
}

function pauseTimer() {
    isRunning = false;
    document.getElementById('startButton').disabled = false;
    document.getElementById('pauseButton').disabled = true;
    clearInterval(interval); // Stop the timer
}

function resetTimer() {
    timer = 0;
    localStorage.removeItem('timer'); // Remove the timer from localStorage
    updateTimerDisplay(); // Update the display to show "00:00:00"
}

function updateTimerDisplay() {
    const hours = Math.floor(timer / 3600); // Calculate hours
    const minutes = Math.floor((timer % 3600) / 60); // Calculate minutes
    const seconds = timer % 60; // Calculate seconds
    document.getElementById('timer').textContent = 
        `${hours < 10 ? '0' : ''}${hours}:${minutes < 10 ? '0' : ''}${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
}

document.getElementById('startButton').addEventListener('click', startTimer);
document.getElementById('pauseButton').addEventListener('click', pauseTimer);
document.getElementById('resetButton').addEventListener('click', resetTimer);

// Streak Logic (for example if you want to track streak of hours above 3)

function checkAndUpdateStreak() {
    const currentTime = timer / 3600; // Convert seconds to hours
    if (currentTime >= 3) {
        if (localStorage.getItem('lastStreakUpdate') !== new Date().toLocaleDateString()) {
            let streak = parseInt(localStorage.getItem('streak') || '0');
            streak++;
            localStorage.setItem('streak', streak); // Store streak in localStorage
            localStorage.setItem('lastStreakUpdate', new Date().toLocaleDateString());
            streakDisplay.textContent = `Current Streak: ${streak} days`;
        }
    }
}

// Real-time clock update (this is the current time shown on the page)
function updateClock() {
    const currentTime = new Date();
    const hours = currentTime.getHours();
    const minutes = currentTime.getMinutes();
    const seconds = currentTime.getSeconds();
    const dayOfWeek = currentTime.toLocaleString('en-us', { weekday: 'long' });
    const month = currentTime.toLocaleString('en-us', { month: 'long' });
    const date = currentTime.getDate();
    const year = currentTime.getFullYear();
    const period = hours >= 12 ? 'PM' : 'AM';
    const displayHours = hours % 12 || 12;
    const displayMinutes = minutes < 10 ? '0' + minutes : minutes;
    const displaySeconds = seconds < 10 ? '0' + seconds : seconds;

    const clockString = `${displayHours}:${displayMinutes}:${displaySeconds} ${period}`;
    const dateString = `${dayOfWeek}, ${month} ${date}, ${year}`;

    document.getElementById('clock').textContent = clockString;
    document.getElementById('dateDay').textContent = dateString;
}

// Update the clock every second
setInterval(updateClock, 1000);
